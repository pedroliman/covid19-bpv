% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[11pt]{article} % use larger type; default would be 10pt

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% Examples of Article customizations
% These packages are optional, depending whether you want the features they provide.
% See the LaTeX Companion or other references for full information.

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{letterpaper} % or letterpaper (US) or a5paper or....
\usepackage{amsmath}
% \geometry{margin=2in} % for example, change the margins to 2 inches all round
% \geometry{landscape} % set up the page for landscape
%   read geometry.pdf for detailed page layout information

\usepackage{graphicx} % support the \includegraphics command and options

% \usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent

%%% PACKAGES
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
% These packages are all incorporated in the memoir class to one degree or another...

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!

%%% END Article customizations

%%% The "real" document content comes below...

\title{Mitigation vs. Suppression Social Distancing}
\author{Sarah A. Nowak}
\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed 

\begin{document}
\maketitle

\section{Single Compartment SIR Model}

Euler-Lagrange Equation:
\begin{equation}
\frac{d}{dt} \frac{\partial \cal{L}}{\partial {\dot{x_i}}}-\frac{\partial \cal{L}}{\partial x_i}
\end{equation}
 which becomes:
\begin{equation}
\frac{d}{dt} \frac{\partial \cal{L}}{\partial {\dot{x_i}}}=\frac{\partial \cal{L}}{\partial x_i}
\label{eq:EL}
\end{equation}


\begin{equation}
\dot{S}= b-\frac{\beta IS}{N}
\end{equation}



\begin{equation}
\dot{I}=\frac{\beta IS}{N}-\gamma I
\label{eq:didt}
\end{equation}

\begin{equation}
\dot{R}=\gamma I
\end{equation}

Cost function:
\begin{equation}
-a\rm{ln}({\beta})+c\beta+\frac{\beta IS}{N}
\label{eq:cost}
\end{equation}

The full Lagrangian, including constraints for the equations of motion is:
\begin{equation}
\begin{split}
\mathcal{L} = -a \rm {ln}({\beta})+c\beta+\frac{\beta IS}{N} +\\
\lambda_S(\dot{S} +\frac{\beta IS}{N})+\\
\lambda_I(\dot{I}-\frac{\beta IS}{N}+\gamma I)
\end{split}
\end{equation}
We leave out the constraint for $R$ because it doesn't factor into the cost equation.

Apply equation 1 $x_i = S$

\begin{equation}
\frac{d}{dt}\left(\lambda_s \right)=\left(\frac{\beta I}{N}+\lambda_S \frac{\beta I}{N} - \lambda_I \frac{\beta I}{N}\right)
\end{equation}

\begin{equation}
\dot{\lambda}_S = \frac{\beta I}{N}(1 + \lambda_S-\lambda_I)
\end{equation}

Apply equation 1 $x_i = I$:
\begin{equation}
\dot{\lambda}_I = \frac{\beta S}{N}(1+\lambda_S-\lambda_I)+\gamma \lambda_I
\end{equation}

Apply equation 1 $x_i = \beta$:
\begin{equation}
-\frac{a}{\beta}+c+\frac{IS}{N}+\lambda_S \frac{IS}{N}-\lambda_I \frac{IS}{N}
\end{equation}
which becomes
\begin{equation}
\frac{a}{\beta} = c + \frac{IS}{N}(1+\lambda_S-\lambda_I)
\end{equation}

\begin{equation}
\beta = \frac{a}{c+\frac{IS}{N}(1+\lambda_S-\lambda_I)}
\end{equation}


When the infection rate is very low, we expect $\beta$ to be:
\begin{equation}
\frac{a}{c}
\end{equation}


Individual, myopic optimum: 
\begin{equation}
\frac{d}{d \beta}\left[-a\rm{ln}({\beta})+c\beta+\beta\frac{ IS}{N}\right] = 0
\end{equation}
which becomes 
\begin{equation}
-\frac{a}{\beta}+c+\frac{IS}{N} = 0
\end{equation}

\begin{equation}
\frac{a}{\beta} = c+\frac{IS}{N}
\end{equation}

\begin{equation}
\beta = \frac{a}{c+\frac{IS}{N}}
\end{equation}


\section{Model with exponential discounting}
Here, we add exponential discounting to the single-compartment SIR model. 
Adding exponential discounting to the cost function in Eq. \ref{eq:cost}, we have:
\begin{equation}
e^{-\alpha t}\left(-a\rm{ln}({\beta})+c\beta+\frac{\beta IS}{N}\right)
\end{equation}

 The full Lagrangian equation becomes:
\begin{equation}
\begin{split}
\mathcal{L} =e^{-\alpha t} \left(-a \rm {ln}({\beta})+c\beta+\frac{\beta IS}{N}\right) +\\
\lambda_S(\dot{S} +\frac{\beta IS}{N})+\\
\lambda_I(\dot{I}-\frac{\beta IS}{N}+\gamma I)
\end{split}
\end{equation}

Applying Eq. \ref{eq:EL} with $x_i = S$, we have 
\begin{equation}
\dot{\lambda}_S = e^{-\alpha t}(\frac{\beta I}{N})+\lambda_S \frac{\beta I}{N}-\lambda_I \frac{\beta I}{N}
\end{equation}
which becomes
\begin{equation}
\dot{\lambda}_S = \frac{\beta I}{N}\left( e^{\alpha t}+\lambda_S-\lambda_I \right)
\end{equation}
then, applying Eq. \ref{eq:EL} with $x_i = I$, we get:
\begin{equation}
\dot{\lambda}_I = e^{-\alpha t}\frac{\beta S}{N}+\lambda_S \frac{\beta S}{N}+\lambda_I(\gamma-\frac{\beta S}{N})
\end{equation}
which becomes
\begin{equation}
\dot{\lambda}_I = \frac{\beta S}{N}(e^{\alpha t}+\lambda_S-\lambda_I)+\gamma \lambda_I
\end{equation}
then, applying Eq. \ref{eq:EL} with $x_i = \beta$, we get:
\begin{equation}
0=e^{-\alpha t}(-\frac{a}{\beta}+c+\frac{IS}{N})+(\lambda_S-\lambda_I)\frac{IS}{N}
\end{equation}
\begin{equation}
\frac{a}{\beta} = c+\frac{IS}{N}+e^{\alpha t}(\lambda_S-\lambda_I)\frac{IS}{N}
\end{equation}

\begin{equation}
\frac{a}{\beta} = c+\frac{IS}{N}(1+e^{\alpha t}(\lambda_S-\lambda_I))
\end{equation}

\begin{equation}
\beta = \frac{a}{c+\frac{IS}{N}(1+e^{\alpha t}\lambda_S-e^{\alpha t}\lambda_I)}
\end{equation}

\section{Multi-Compartment SIR Model}
\begin{equation}
\dot{S_i} = -\frac{1}{N}\sum_j{\beta_{ij}I_jS_i}
\end{equation}

\begin{equation}
\dot{I_i} = \frac{1}{N}\sum_j{\beta_{ij}I_jS_i}-\gamma I_i
\end{equation}

Cost function:
\begin{equation}
\mathcal{C} =\sum_i N_i\left( -a_{ij}\rm{ln}({\beta_{ij}})+c\beta_{ij}+\frac{\beta_{ij}{I_jS_i}}{N_j}\right)
\end{equation}
Lagrangian:
\begin{equation}
\mathcal{L} = \sum_i N_i\left( -a_{ij}\rm{ln}({\beta_{ij}})+c\beta_{ij}+\frac{\beta_{ij}{I_jS_i}}{N}\right)+
\sum_i \lambda_{S,i}\left( \dot{S}_i+\frac{1}{N}\sum_j{\beta_{ij}I_jS_i}\right)+\sum_i \lambda_{I,i}\left(\dot{I}_i -\frac{\beta_{ij}I_jS_i}{N}+\gamma I_i  \right)
\end{equation}
\end{document}
